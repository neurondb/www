<svg width="1000" height="500" viewBox="0 0 1000 500" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="boxGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1e293b;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#0f172a;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="cyanGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#06b6d4;stop-opacity:0.3" />
      <stop offset="100%" style="stop-color:#0891b2;stop-opacity:0.2" />
    </linearGradient>
    <filter id="glow">
      <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    <marker id="arrowhead" markerWidth="8" markerHeight="8" refX="8" refY="4" orient="auto">
      <polygon points="0 0, 8 4, 0 8" fill="#06b6d4"/>
    </marker>
  </defs>

  <!-- Title -->

  <text x="500" y="40" font-family="system-ui, sans-serif" font-size="24" font-weight="bold" fill="#e5e7eb" text-anchor="middle">
    Agent Execution Flow
  </text>

  <!-- User -->

  <g id="user" transform="translate(40, 100)">
    <rect x="0" y="0" width="160" height="100" rx="8" fill="url(#boxGrad)" stroke="#06b6d4" stroke-width="2" filter="url(#glow)"/>
    <rect x="5" y="5" width="150" height="90" rx="6" fill="url(#cyanGrad)"/>
    <text x="80" y="40" font-family="system-ui, sans-serif" font-size="18" font-weight="bold" fill="#ffffff" text-anchor="middle">
      User
    </text>
    <text x="80" y="65" font-family="system-ui, sans-serif" font-size="14" fill="#cbd5e1" text-anchor="middle">
      Sends request
    </text>
  </g>

  <!-- Agent Runtime -->

  <g id="runtime" transform="translate(240, 100)">
    <rect x="0" y="0" width="160" height="100" rx="8" fill="url(#boxGrad)" stroke="#06b6d4" stroke-width="2" filter="url(#glow)"/>
    <rect x="5" y="5" width="150" height="90" rx="6" fill="url(#cyanGrad)"/>
    <text x="80" y="35" font-family="system-ui, sans-serif" font-size="18" font-weight="bold" fill="#ffffff" text-anchor="middle">
      Agent runtime
    </text>
    <text x="80" y="58" font-family="system-ui, sans-serif" font-size="14" fill="#cbd5e1" text-anchor="middle">
      Orchestrates components
    </text>
    <circle cx="80" cy="82" r="4" fill="#06b6d4"/>
  </g>

  <!-- Planner -->

  <g id="planner" transform="translate(440, 100)">
    <rect x="0" y="0" width="160" height="100" rx="8" fill="url(#boxGrad)" stroke="#06b6d4" stroke-width="2" filter="url(#glow)"/>
    <rect x="5" y="5" width="150" height="90" rx="6" fill="url(#cyanGrad)"/>
    <text x="80" y="35" font-family="system-ui, sans-serif" font-size="18" font-weight="bold" fill="#ffffff" text-anchor="middle">
      Planner
    </text>
    <text x="80" y="58" font-family="system-ui, sans-serif" font-size="14" fill="#cbd5e1" text-anchor="middle">
      Builds execution plan
    </text>
    <circle cx="80" cy="82" r="4" fill="#06b6d4"/>
  </g>

  <!-- Tool Executor -->

  <g id="executor" transform="translate(640, 100)">
    <rect x="0" y="0" width="160" height="100" rx="8" fill="url(#boxGrad)" stroke="#06b6d4" stroke-width="2" filter="url(#glow)"/>
    <rect x="5" y="5" width="150" height="90" rx="6" fill="url(#cyanGrad)"/>
    <text x="80" y="32" font-family="system-ui, sans-serif" font-size="18" font-weight="bold" fill="#ffffff" text-anchor="middle">
      Tool executor
    </text>
    <text x="80" y="55" font-family="system-ui, sans-serif" font-size="14" fill="#cbd5e1" text-anchor="middle">
      Calls tools, APIs,
    </text>
    <text x="80" y="72" font-family="system-ui, sans-serif" font-size="14" fill="#cbd5e1" text-anchor="middle">
      handles errors
    </text>
    <circle cx="80" cy="82" r="4" fill="#06b6d4"/>
  </g>

  <!-- Memory System -->

  <g id="memory" transform="translate(840, 100)">
    <rect x="0" y="0" width="160" height="100" rx="8" fill="url(#boxGrad)" stroke="#06b6d4" stroke-width="2" filter="url(#glow)"/>
    <rect x="5" y="5" width="150" height="90" rx="6" fill="url(#cyanGrad)"/>
    <text x="80" y="32" font-family="system-ui, sans-serif" font-size="18" font-weight="bold" fill="#ffffff" text-anchor="middle">
      Memory
    </text>
    <text x="80" y="55" font-family="system-ui, sans-serif" font-size="14" fill="#cbd5e1" text-anchor="middle">
      Stores user and
    </text>
    <text x="80" y="72" font-family="system-ui, sans-serif" font-size="14" fill="#cbd5e1" text-anchor="middle">
      task context
    </text>
    <circle cx="80" cy="82" r="4" fill="#06b6d4"/>
  </g>

  <!-- State Machine -->

  <g id="state" transform="translate(240, 280)">
    <rect x="0" y="0" width="160" height="100" rx="8" fill="url(#boxGrad)" stroke="#10b981" stroke-width="2" filter="url(#glow)"/>
    <rect x="5" y="5" width="150" height="90" rx="6" fill="#022c22"/>
    <text x="80" y="32" font-family="system-ui, sans-serif" font-size="18" font-weight="bold" fill="#a7f3d0" text-anchor="middle">
      State machine
    </text>
    <text x="80" y="55" font-family="system-ui, sans-serif" font-size="14" fill="#a7f3d0" text-anchor="middle">
      Tracks progress
    </text>
    <text x="80" y="72" font-family="system-ui, sans-serif" font-size="14" fill="#a7f3d0" text-anchor="middle">
      and status
    </text>
  </g>

  <!-- Response -->

  <g id="response" transform="translate(440, 280)">
    <rect x="0" y="0" width="160" height="100" rx="8" fill="url(#boxGrad)" stroke="#10b981" stroke-width="2" filter="url(#glow)"/>
    <rect x="5" y="5" width="150" height="90" rx="6" fill="#022c22"/>
    <text x="80" y="35" font-family="system-ui, sans-serif" font-size="18" font-weight="bold" fill="#a7f3d0" text-anchor="middle">
      Response
    </text>
    <text x="80" y="58" font-family="system-ui, sans-serif" font-size="14" fill="#a7f3d0" text-anchor="middle">
      Final answer
    </text>
  </g>

  <!-- User Output -->

  <g id="user-output" transform="translate(640, 280)">
    <rect x="0" y="0" width="160" height="100" rx="8" fill="url(#boxGrad)" stroke="#10b981" stroke-width="2" filter="url(#glow)"/>
    <rect x="5" y="5" width="150" height="90" rx="6" fill="#022c22"/>
    <text x="80" y="32" font-family="system-ui, sans-serif" font-size="18" font-weight="bold" fill="#a7f3d0" text-anchor="middle">
      User output
    </text>
    <text x="80" y="55" font-family="system-ui, sans-serif" font-size="14" fill="#a7f3d0" text-anchor="middle">
      Shown in UI
    </text>
  </g>

  <!-- Main arrows: strictly horizontal -->

  <path d="M 200 150 H 240" fill="none" stroke="#06b6d4" stroke-width="2" marker-end="url(#arrowhead)" opacity="0.8"/>
  <path d="M 400 150 H 440" fill="none" stroke="#06b6d4" stroke-width="2" marker-end="url(#arrowhead)" opacity="0.8"/>
  <path d="M 600 150 H 640" fill="none" stroke="#06b6d4" stroke-width="2" marker-end="url(#arrowhead)" opacity="0.8"/>
  <path d="M 800 150 H 840" fill="none" stroke="#06b6d4" stroke-width="2" marker-end="url(#arrowhead)" opacity="0.8"/>

  <!-- Memory and executor to response: vertical then horizontal, dashed -->

  <path d="M 720 200 V 280 H 520" fill="none" stroke="#06b6d4" stroke-width="2" stroke-dasharray="4,4" marker-end="url(#arrowhead)" opacity="0.8"/>
  <path d="M 920 200 V 280 H 520" fill="none" stroke="#06b6d4" stroke-width="2" stroke-dasharray="4,4" marker-end="url(#arrowhead)" opacity="0.8"/>

  <!-- Response to user output -->

  <path d="M 600 330 H 640" fill="none" stroke="#10b981" stroke-width="2" marker-end="url(#arrowhead)" opacity="0.9"/>
</svg>

